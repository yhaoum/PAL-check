"0","# Parameters for running Metropolis-Hastings algorithm"
"0","burnin_steps <- 0         # num of steps to ""burn-in"" each chain"
"0","n_chains <- 1             # num of chains to run"
"0","num_saved_steps <- 10000  # total num of steps to save"
"0","thin_steps <- 1           # num of steps to ""thin"" (1=keep every step)"
"0","n_iter <- ceiling((num_saved_steps * thin_steps) / n_chains)  # steps / chain"
"0",""
"0","# Initialize vector of sampled unknown parameter values, and select starting"
"0","# value for each chain. R is column-major so save each chain in a column"
"0","theta <- rep(0,burnin_steps + n_iter)"
"0",""
"0","for (s in seq(2, burnin_steps + n_iter)) {"
"0","    # Propose a new value for theta (symmetric normal proposal distribution)"
"0","    theta_star <- rcauchy(1)"
"0","    # Compute acceptance ratio using logarithms - more stable numerically"
"0","    r <- exp(-abs(theta_star))*(1+theta_star^2)/(exp(-abs(theta[s-1]))*(1+theta[s-1]^2))"
"0","    # Accept theta_star with probability min{1,r}, otherwise reject"
"0","    # Equivalent to flipping a coin with probability min{1,r}"
"0","    if (runif(1) < r) {"
"0","      theta[s] <- theta_star"
"0","    }"
"0","    else {"
"0","      theta[s] <- theta[s-1]"
"0","    }"
"0","  }"
"0",""
"0","n <- 100000"
"0","a <- seq(min(theta), max(theta), length=n)"
"0","y <- dlaplace(a)"
"0","yy <- rlaplace(n)"
"0","dat <- data.frame(theta,y,a)"
"0","hist(theta, prob=T, ylim = c(0, max(y)))"
