"0","# File read-in"
"0","nutri_data <- read.xlsx(""Nutrdata_UROP.xlsx"", rowNames = T)"
"0","#BMI Status"
"0","nutri_data$BMI_stat <- cut(nutri_data$BMI, c(0,18.5, 25, 30, 100))"
"0","levels(nutri_data$BMI_stat) <- c(""underweight"", ""healthy"", ""overweight"", ""obese"")"
"0",""
"0","feature_data <- t(read.xlsx(""feature_modified.xlsx"", rowNames = T))"
"0","## ASV[i] + labels"
"0","tax <- read.csv(""taxonomy_for_phyloseq.csv"", row.names = 1)"
"0","#labels <- tax[colnames(feature_data),c(""Genus"")]"
"0","asv <- paste0(""ASV"", c(1:ncol(feature_data)))"
"0","# colnames(feature_data) <- asv"
"0",""
"0","mch <- match(rownames(nutri_data), rownames(feature_data))"
"0","comb_data <- merge(nutri_data, feature_data, by = 0)"
"0","rownames(comb_data) <- comb_data[, 1]"
"0","my_data <- comb_data[, -1]"
"0","#rowSums(feature_data)"
"0",""
"0","clinic <- cbind(BMI_stat = my_data$BMI_stat, my_data[, c(1:17)])"
"0",""
"0","any(is.na(clinic))"
"1","[1]"
"1"," TRUE"
"1","
"
"0","# a <- c()"
"0","# for( j in 1:ncol(clinic)){"
"0","#   if(any(is.na(clinic[,j])) || var(clinic[, j] == 0)){"
"0","#     a[j] <- 1;"
"0","#   }"
"0","#   else{"
"0","#     a[j] = 0;"
"0","#   }"
"0","# }"
"0","# which(a == 1)"
"0","# clinic <- clinic[, -which(a == 1)]"
"0","# any(is.na(clinic))"
"0","clinic$SEX <- as.factor(clinic$SEX)"
"0","clinic$Group <- as.factor(clinic$Group)"
"0","clinic$Patient_Type <- as.factor(clinic$Patient_Type)"
"0",""
"0","nutrition <- my_data[, c(18:234)]"
"0",""
"0","any(is.na(nutrition))"
"1","[1]"
"1"," FALSE"
"1","
"
"0","# a <- c()"
"0","# for( j in 1:ncol(nutrition)){"
"0","#   if(any(is.na(nutrition[,j])) || var(nutrition[, j]) == 0){"
"0","#     a[j] <- 1;"
"0","#   }"
"0","#   else{"
"0","#     a[j] = 0;"
"0","#   }"
"0","# }"
"0","# which(a == 1)"
"0","# nutrition <- nutrition[, -which(a == 1)]"
"0","# any(is.na(nutrition))"
"0",""
"0","gene <- my_data[, c(235:ncol(my_data))]"
"0","any(is.na(gene))"
"1","[1]"
"1"," FALSE"
"1","
"
"0","# a <- c()"
"0","# for( j in 1:ncol(gene)){"
"0","#   if(any(is.na(gene[,j])) || var(gene[, j]) == 0){"
"0","#     a[j] <- 1;"
"0","#   }"
"0","#   else{"
"0","#     a[j] = 0;"
"0","#   }"
"0","# }"
"0",""
"0","# gene_1 <- gene[, -which(a == 1)]"
"0","# tax_1 <- tax[-which(a == 1), ]"
"0","## fill tax to genus level"
"0","tax[tax ==""""] = NA"
"0","for(i in 1: nrow(tax)){"
"0","  if(is.na(tax[i, 6])){"
"0","    tax[i, 6] <- tax[i, max(which(!is.na(tax[i, ])))]"
"0","  }"
"0","}"
"0",""
"0","rel_otu <- gene/ rowSums(gene)"
"0","b <- apply(rel_otu, 2, mean)"
"0","cleaned_rel_otu <- rel_otu[, -which(b < 0.001)]"
"0","cleaned_count_otu <- gene[, -which(b < 0.001)]"
"0","cleaned_tax <- tax[-which(b < 0.001), ]"
"0",""
"0","nutrition[,161]"
"1"," [1]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"1","[24]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"1","[47]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"0","nutrition[,162]"
"1"," [1]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"1","[24]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"1","[47]"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1"," 0"
"1","
"
"0","asthma.patient <- list(clinic = clinic, nutrition = nutrition[, -c(161,162,217)], count_otu = gene, rel_otu = rel_otu, cleaned_count_otu = cleaned_count_otu, cleaned_rel_otu = cleaned_rel_otu, tax= tax, cleaned_tax = cleaned_tax)"
